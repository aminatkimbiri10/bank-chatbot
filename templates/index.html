<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Assistant BDM-SA</title>
<style>
body { font-family: Arial; background:#f4f6f9; }
#chat { width:420px; margin:40px auto; background:#fff; padding:15px; border-radius:12px; }
.msg { margin:10px 0; padding:10px; border-radius:10px; }
.user { background:#dbeafe; text-align:right; }
.bot { background:#e5e7eb; }
button { margin:5px; padding:8px 12px; border:none; border-radius:8px; background:#004080; color:white; cursor:pointer;}
</style>
</head>
<body>

<div id="chat"></div>
<input id="q" placeholder="Posez votre question..." style="width:320px">
<button onclick="send()">Envoyer</button>

<script>
let sessionId = null;

async function send(text=null){
  const q = text || document.getElementById("q").value;
  document.getElementById("chat").innerHTML += `<div class='msg user'>${q}</div>`;
  document.getElementById("q").value="";

  const res = await fetch(`/chatbot?question=${q}&session_id=${sessionId||""}`);
  const data = await res.json();
  sessionId = data.session_id;

  data.responses.forEach(r=>{
    document.getElementById("chat").innerHTML += `<div class='msg bot'>${r.answer}</div>`;
    if(r.suggestions){
      r.suggestions.forEach(s=>{
        document.getElementById("chat").innerHTML += `<button onclick="send('${s}')">${s}</button>`;
      });
    }
  });
}
</script>

</body>
</html>
